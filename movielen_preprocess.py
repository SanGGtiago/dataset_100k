# -*- coding: utf-8 -*-
"""movielen_preprocess.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/102TH4IXpQBr1n9uCS_P5w63rAJ7dkp76
"""

import pandas as pd

dataset = pd.read_csv('ml-100k/u.data', delimiter='\t', header=None, names=['userID', 'movieID', 'rating', 'timestemp'])

dataset.head()

new_data = dataset.sort_values('timestemp')
new_data.head()

from datetime import datetime

data = new_data.to_numpy()

for i in range(data.shape[0]):
  time = datetime.utcfromtimestamp(data[i, 3])
  data[i, 3] = int(time.strftime('%m'))
print(data[0])
print(data[-1])

mon = []

m = -1
for i in range(data.shape[0]):
  if data[i-1, 3] != data[i, 3]:
    mon.append([])
    m += 1
  mon[m].append(data[i])

print(len(mon))

import numpy as np
import pandas as pd

for i in range(8):
  data = pd.DataFrame(np.array(mon[i]))
  data.to_csv(f'result/mon{i}.csv', index=False, header=None)



